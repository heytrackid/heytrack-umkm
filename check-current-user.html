<!DOCTYPE html>
<html>
<head>
    <title>Check Current User</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Current User Check</h1>
    <div id="result"></div>

    <script>
        const supabaseUrl = 'https://vrrjoswzmlhkmmcfhicw.supabase.co'
        const supabaseKey = 'sb_publishable_tpQT__d0CVP5L6BBBoBY6g_6YDOlmRw'
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)

        async function checkUser() {
            const { data: { user }, error } = await supabase.auth.getUser()
            
            const resultDiv = document.getElementById('result')
            
            if (error) {
                resultDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`
                return
            }

            if (!user) {
                resultDiv.innerHTML = '<p style="color: orange;">No user logged in</p>'
                return
            }

            resultDiv.innerHTML = `
                <h2>Logged in as:</h2>
                <p><strong>Email:</strong> ${user.email}</p>
                <p><strong>User ID:</strong> ${user.id}</p>
                <p><strong>Created:</strong> ${new Date(user.created_at).toLocaleString()}</p>
            `

            // Check recipes for this user
            const { data: recipes, error: recipesError } = await supabase
                .from('recipes')
                .select('id, name, is_active')
                .eq('is_active', true)

            if (recipesError) {
                resultDiv.innerHTML += `<p style="color: red;">Error fetching recipes: ${recipesError.message}</p>`
            } else {
                resultDiv.innerHTML += `
                    <h3>Your Recipes (${recipes.length}):</h3>
                    <ul>
                        ${recipes.map(r => `<li>${r.name}</li>`).join('')}
                    </ul>
                `
            }
        }

        checkUser()
    </script>
</body>
</html>
